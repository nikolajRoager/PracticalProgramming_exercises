----------------------------------------------
Demonstrating Quasi newton optimization method
----------------------------------------------
Demonstration one, find max of f(x)=exp(-(x-2)^2) (true solution x=2
Starting at x0 = (0.0) with precision 10^-3. Now Running ...
Step 0
x=|    0.00000 |

Numeric ∇ f(x)=|   -0.07326 |


This step x -> |    0.07326 |
This step f(x) -> -0.0244208701964465

∇f(x + s)|   -0.09411 |
HAVE 
y=|   -0.02084 |

u=|    0.09411 |
SO dot(y,u)=-0.00196140219950456
UPDATED B
B=|   -3.51503 |
Step 1
x=|    0.07326 |

Numeric ∇ f(x)=|   -0.09411 |


This step x -> |    0.07326 |
This step f(x) -> -0.0244208701891989

∇f(x + s)|   -0.09411 |
HAVE 
y=|   0.00000 |

u=|   0.00000 |
SO dot(y,u)=3.12052986513355E-18
Reset B to identity
B=|    1.00000 |
Step 2
x=|    0.07326 |

Numeric ∇ f(x)=|   -0.09411 |


This step x -> |    0.16737 |
This step f(x) -> -0.0347859780451206

∇f(x + s)|   -0.12750 |
HAVE 
y=|   -0.03339 |

u=|    0.12750 |
SO dot(y,u)=-0.00425780445358077
UPDATED B
B=|   -2.81798 |
Step 3
x=|    0.16737 |

Numeric ∇ f(x)=|   -0.12750 |


This step x -> |    0.16737 |
This step f(x) -> -0.0347859780344548

∇f(x + s)|   -0.12750 |
HAVE 
y=|   0.00000 |

u=|   0.00000 |
SO dot(y,u)=3.94189258409838E-17
Reset B to identity
B=|    1.00000 |
Step 4
x=|    0.16737 |

Numeric ∇ f(x)=|   -0.12750 |


This step x -> |    0.29487 |
This step f(x) -> -0.0546133684068931

∇f(x + s)|   -0.18625 |
HAVE 
y=|   -0.05875 |

u=|    0.18625 |
SO dot(y,u)=-0.0109412568121186
UPDATED B
B=|   -2.17035 |
Step 5
x=|    0.29487 |

Numeric ∇ f(x)=|   -0.18625 |


This step x -> |    0.29487 |
This step f(x) -> -0.0546133683893647

∇f(x + s)|   -0.18625 |
HAVE 
y=|    0.00000 |

u=|    0.00000 |
SO dot(y,u)=4.70593937210034E-17
Reset B to identity
B=|    1.00000 |
Step 6
x=|    0.29487 |

Numeric ∇ f(x)=|   -0.18625 |


This step x -> |    0.48111 |
This step f(x) -> -0.0995579081745254

∇f(x + s)|   -0.30243 |
HAVE 
y=|   -0.11619 |

u=|    0.30243 |
SO dot(y,u)=-0.0351393118020893
UPDATED B
B=|   -1.60297 |
Step 7
x=|    0.48111 |

Numeric ∇ f(x)=|   -0.30243 |


This step x -> |    0.48111 |
This step f(x) -> -0.0995579081403882

∇f(x + s)|   -0.30243 |
HAVE 
y=|   0.00000 |

u=|   0.00000 |
SO dot(y,u)=2.53602139554228E-17
Reset B to identity
B=|    1.00000 |
Step 8
x=|    0.48111 |

Numeric ∇ f(x)=|   -0.30243 |


This step x -> |    0.78355 |
This step f(x) -> -0.22769332215542

∇f(x + s)|   -0.55396 |
HAVE 
y=|   -0.25152 |

u=|    0.55396 |
SO dot(y,u)=-0.139331978700184
UPDATED B
B=|   -1.20242 |
Step 9
x=|    0.78355 |

Numeric ∇ f(x)=|   -0.55396 |


This step x -> |    0.78355 |
This step f(x) -> -0.22769332206951

∇f(x + s)|   -0.55396 |
HAVE 
y=|   0.00000 |

u=|   0.00000 |
SO dot(y,u)=7.8218541427001E-18
Reset B to identity
B=|    1.00000 |
Step 10
x=|    0.78355 |

Numeric ∇ f(x)=|   -0.55396 |


This step x -> |    1.33750 |
This step f(x) -> -0.644744610304331

∇f(x + s)|   -0.85428 |
HAVE 
y=|   -0.30033 |

u=|    0.85428 |
SO dot(y,u)=-0.256562475370755
UPDATED B
B=|   -1.84452 |
Step 11
x=|    1.33750 |

Numeric ∇ f(x)=|   -0.85428 |


This step x -> |    1.33750 |
This step f(x) -> -0.644744609990912

∇f(x + s)|   -0.85428 |
HAVE 
y=|   0.00000 |

u=|   0.00000 |
SO dot(y,u)=6.42829573293015E-17
Reset B to identity
B=|    1.00000 |
Step 12
x=|    1.33750 |

Numeric ∇ f(x)=|   -0.85428 |


This step x -> |    2.19179 |
This step f(x) -> -0.963886564373737

∇f(x + s)|    0.36972 |
HAVE 
y=|    1.22400 |

u=|   -0.36972 |
SO dot(y,u)=-0.452536057788969
UPDATED B
B=|    0.69794 |
Step 13
x=|    2.19179 |

Numeric ∇ f(x)=|    0.36972 |


This step x -> |    1.93374 |
This step f(x) -> -0.995619639191678

∇f(x + s)|   -0.13193 |
HAVE 
y=|   -0.50165 |

u=|    0.09208 |
SO dot(y,u)=-0.046193090473055
UPDATED B
B=|    0.51438 |
Step 14
x=|    1.93374 |

Numeric ∇ f(x)=|   -0.13193 |


This step x -> |    2.00161 |
This step f(x) -> -0.999997415567695

∇f(x + s)|    0.00322 |
HAVE 
y=|    0.13515 |

u=|   -0.00165 |
SO dot(y,u)=-0.000223519728194871
UPDATED B
B=|    0.50215 |
Step 15
x=|    2.00161 |

Numeric ∇ f(x)=|    0.00322 |


This step x -> |    1.99999 |
This step f(x) -> -0.999999999952173

∇f(x + s)|   -0.00001 |
HAVE 
y=|   -0.00323 |

u=|    0.00001 |
SO dot(y,u)=-2.23798555666046E-08
Reset B to identity
B=|    1.00000 |
BREAK DUE TO: gradient reached target

Got predicted max at x=|    1.99999 |
FAIL this is not within 10^-3 of 2.0

Demonstration Rosenbrock, find minimum of f(x,y)=() (minimum is at 1,1)
Starting at x0 = (0,0) with precision 10^-3. Now Running ...
Step 0
  |    0.00000 |
x=|    0.00000 |

               |   -2.00000 |
Numeric ∇ f(x)=|    0.00000 |


               |    0.25000 |
This step x -> |   0.00000 |
This step f(x) -> 0.953125558793745

         |    4.75000 |
∇f(x + s)|  -12.50001 |
HAVE 
  |    6.75000 |
y=|  -12.50001 |

  |   -6.50000 |
u=|   12.50001 |
SO dot(y,u)=-200.125284165245
UPDATED B
  |    0.78888    0.40600 |
B=|    0.40600    0.21924 |
Step 1
  |    0.25000 |
x=|   0.00000 |

               |    4.75000 |
Numeric ∇ f(x)=|  -12.50001 |


               |    0.41597 |
This step x -> |    0.10150 |
This step f(x) -> 0.852779156186488

         |   10.73409 |
∇f(x + s)|  -14.30648 |
HAVE 
  |    5.98409 |
y=|   -1.80647 |

  |   -3.82135 |
u=|   -1.93197 |
SO dot(y,u)=-19.3772043432913
UPDATED B
  |    0.03528    0.02500 |
B=|    0.02500    0.02661 |
Step 2
  |    0.41597 |
x=|    0.10150 |

               |   10.73409 |
Numeric ∇ f(x)=|  -14.30648 |


               |    0.39486 |
This step x -> |    0.21395 |
This step f(x) -> 0.702970236584099

         |  -10.37626 |
∇f(x + s)|   11.60654 |
HAVE 
  |  -21.11035 |
y=|   25.91303 |

  |    0.07597 |
u=|   -0.04954 |
SO dot(y,u)=-2.8874231936444
UPDATED B
  |    0.03328    0.02630 |
B=|    0.02630    0.02576 |
Step 3
  |    0.39486 |
x=|    0.21395 |

               |  -10.37626 |
Numeric ∇ f(x)=|   11.60654 |


               |    0.43497 |
This step x -> |    0.18780 |
This step f(x) -> 0.31945870217314

         |   -0.88745 |
∇f(x + s)|   -0.27890 |
HAVE 
  |    9.48882 |
y=|  -11.88544 |

  |    0.03687 |
u=|    0.03052 |
SO dot(y,u)=-0.0129386757498741
UPDATED B
  |   -0.07179   -0.06069 |
B=|   -0.06069   -0.04625 |
Step 4
  |    0.43497 |
x=|    0.18780 |

               |   -0.88745 |
Numeric ∇ f(x)=|   -0.27890 |


               |    0.43497 |
This step x -> |    0.18780 |
This step f(x) -> 0.319458702194135

         |   -0.88745 |
∇f(x + s)|   -0.27890 |
HAVE 
  |   0.00000 |
y=|    0.00000 |

  |   0.00000 |
u=|   0.00000 |
SO dot(y,u)=8.2444184015118E-22
Reset B to identity
  |    1.00000    0.00000 |
B=|    0.00000    1.00000 |
Step 5
  |    0.43497 |
x=|    0.18780 |

               |   -0.88745 |
Numeric ∇ f(x)=|   -0.27890 |


               |    0.44883 |
This step x -> |    0.19216 |
This step f(x) -> 0.312420279276691

         |    0.56584 |
∇f(x + s)|   -1.85836 |
HAVE 
  |    1.45329 |
y=|   -1.57946 |

  |   -1.43942 |
u=|    1.58382 |
SO dot(y,u)=-4.59347788390438
UPDATED B
  |    0.54894    0.49631 |
B=|    0.49631    0.45390 |
Step 6
  |    0.44883 |
x=|    0.19216 |

               |    0.56584 |
Numeric ∇ f(x)=|   -1.85836 |


               |    0.60176 |
This step x -> |    0.33283 |
This step f(x) -> 0.244353036474277

         |    6.25233 |
∇f(x + s)|   -5.85685 |
HAVE 
  |    5.68649 |
y=|   -3.99849 |

  |   -0.98412 |
u=|   -0.86665 |
SO dot(y,u)=-2.13086452348511
UPDATED B
  |    0.09443    0.09605 |
B=|    0.09605    0.10142 |
Step 7
  |    0.60176 |
x=|    0.33283 |

               |    6.25233 |
Numeric ∇ f(x)=|   -5.85685 |


               |    0.57390 |
This step x -> |    0.32629 |
This step f(x) -> 0.182505791051187

         |   -0.14663 |
∇f(x + s)|   -0.61471 |
HAVE 
  |   -6.39896 |
y=|    5.24213 |

  |    0.07289 |
u=|    0.07643 |
SO dot(y,u)=-0.0657771855742665
UPDATED B
  |    0.01366    0.01136 |
B=|    0.01136    0.01261 |
Step 8
  |    0.57390 |
x=|    0.32629 |

               |   -0.14663 |
Numeric ∇ f(x)=|   -0.61471 |


               |    0.58288 |
This step x -> |    0.33571 |
This step f(x) -> 0.17562371943202

         |    0.10908 |
∇f(x + s)|   -0.80918 |
HAVE 
  |    0.25571 |
y=|   -0.19446 |

  |    0.00770 |
u=|    0.00897 |
SO dot(y,u)=0.000224744376420372
UPDATED B
  |    0.27739    0.31856 |
B=|    0.31856    0.37045 |
Step 9
  |    0.58288 |
x=|    0.33571 |

               |    0.10908 |
Numeric ∇ f(x)=|   -0.80918 |


               |    0.69664 |
This step x -> |    0.46821 |
This step f(x) -> 0.121246495765789

         |    4.15650 |
∇f(x + s)|   -3.41871 |
HAVE 
  |    4.04742 |
y=|   -2.60953 |

  |   -0.17767 |
u=|   -0.19013 |
SO dot(y,u)=-0.222942381156539
UPDATED B
  |    0.13580    0.16704 |
B=|    0.16704    0.20831 |
Step 10
  |    0.69664 |
x=|    0.46821 |

               |    4.15650 |
Numeric ∇ f(x)=|   -3.41871 |


               |    0.70324 |
This step x -> |    0.48604 |
This step f(x) -> 0.0952912421069187

         |    1.79700 |
∇f(x + s)|   -1.69966 |
HAVE 
  |   -2.35949 |
y=|    1.71904 |

  |    0.03987 |
u=|    0.05388 |
SO dot(y,u)=-0.00146724528735345
UPDATED B
  |   -0.94780   -1.29708 |
B=|   -1.29708   -1.76995 |
Step 11
  |    0.70324 |
x=|    0.48604 |

               |    1.79700 |
Numeric ∇ f(x)=|   -1.69966 |


               |    0.70324 |
This step x -> |    0.48604 |
This step f(x) -> 0.0952912421652317

         |    1.79700 |
∇f(x + s)|   -1.69966 |
HAVE 
  |    0.00000 |
y=|    0.00000 |

  |    0.00000 |
u=|    0.00000 |
SO dot(y,u)=7.21551622178023E-17
Reset B to identity
  |    1.00000    0.00000 |
B=|    0.00000    1.00000 |
Step 12
  |    0.70324 |
x=|    0.48604 |

               |    1.79700 |
Numeric ∇ f(x)=|   -1.69966 |


               |    0.69973 |
This step x -> |    0.48936 |
This step f(x) -> 0.0901710450271572

         |   -0.52929 |
∇f(x + s)|   -0.05092 |
HAVE 
  |   -2.32629 |
y=|    1.64875 |

  |    2.32278 |
u=|   -1.64543 |
SO dot(y,u)=-8.11635029788531
UPDATED B
  |    0.33525    0.47090 |
B=|    0.47090    0.66642 |
Step 13
  |    0.69973 |
x=|    0.48936 |

               |   -0.52929 |
Numeric ∇ f(x)=|   -0.05092 |


               |    0.80044 |
This step x -> |    0.63095 |
This step f(x) -> 0.049335274091161

         |    2.72321 |
∇f(x + s)|   -1.95039 |
HAVE 
  |    3.25250 |
y=|   -1.89947 |

  |   -0.09525 |
u=|   -0.12415 |
SO dot(y,u)=-0.0739669544768841
UPDATED B
  |    0.21261    0.31103 |
B=|    0.31103    0.45804 |
Step 14
  |    0.80044 |
x=|    0.63095 |

               |    2.72321 |
Numeric ∇ f(x)=|   -1.95039 |


               |    0.82809 |
This step x -> |    0.67731 |
This step f(x) -> 0.0366586132556234

         |    2.44848 |
∇f(x + s)|   -1.68598 |
HAVE 
  |   -0.27473 |
y=|    0.26441 |

  |    0.00382 |
u=|    0.01070 |
SO dot(y,u)=0.00177761202107168
UPDATED B
  |    0.22083    0.33404 |
B=|    0.33404    0.52240 |
Step 15
  |    0.82809 |
x=|    0.67731 |

               |    2.44848 |
Numeric ∇ f(x)=|   -1.68598 |


               |    0.83933 |
This step x -> |    0.70874 |
This step f(x) -> 0.0276321245007731

         |   -1.75272 |
∇f(x + s)|    0.85270 |
HAVE 
  |   -4.20120 |
y=|    2.53867 |

  |    0.09099 |
u=|    0.10860 |
SO dot(y,u)=-0.106560030290834
UPDATED B
  |    0.14315    0.24132 |
B=|    0.24132    0.41173 |
Step 16
  |    0.83933 |
x=|    0.70874 |

               |   -1.75272 |
Numeric ∇ f(x)=|    0.85270 |


               |    0.88446 |
This step x -> |    0.78062 |
This step f(x) -> 0.0136206563396974

         |    0.35071 |
∇f(x + s)|   -0.32890 |
HAVE 
  |    2.10343 |
y=|   -1.18159 |

  |    0.02917 |
u=|    0.05079 |
SO dot(y,u)=0.00134027512394259
UPDATED B
  |    0.77782    1.34646 |
B=|    1.34646    2.33608 |
Step 17
  |    0.88446 |
x=|    0.78062 |

               |    0.35071 |
Numeric ∇ f(x)=|   -0.32890 |


               |    0.96949 |
This step x -> |    0.92868 |
This step f(x) -> 0.0135299425042479

         |    4.29174 |
∇f(x + s)|   -2.24488 |
HAVE 
  |    3.94103 |
y=|   -1.91599 |

  |   -0.40059 |
u=|   -0.68246 |
SO dot(y,u)=-0.271137867624763
UPDATED B
  |    0.18598    0.33816 |
B=|    0.33816    0.61830 |
Step 18
  |    0.96949 |
x=|    0.92868 |

               |    4.29174 |
Numeric ∇ f(x)=|   -2.24488 |


               |    0.93045 |
This step x -> |    0.86538 |
This step f(x) -> 0.00485006489468384

         |   -0.00344 |
∇f(x + s)|   -0.07290 |
HAVE 
  |   -4.29518 |
y=|    2.17199 |

  |    0.02529 |
u=|    0.04623 |
SO dot(y,u)=-0.00820526993655304
UPDATED B
  |    0.10803    0.19567 |
B=|    0.19567    0.35780 |
Step 19
  |    0.93045 |
x=|    0.86538 |

               |   -0.00344 |
Numeric ∇ f(x)=|   -0.07290 |


               |    0.94509 |
This step x -> |    0.89213 |
This step f(x) -> 0.00312732224897424

         |    0.29015 |
∇f(x + s)|   -0.21160 |
HAVE 
  |    0.29359 |
y=|   -0.13871 |

  |    0.01006 |
u=|    0.01894 |
SO dot(y,u)=0.000326114941406584
UPDATED B
  |    0.41826    0.77977 |
B=|    0.77977    1.45756 |
Step 20
  |    0.94509 |
x=|    0.89213 |

               |    0.29015 |
Numeric ∇ f(x)=|   -0.21160 |


               |    0.98873 |
This step x -> |    0.97431 |
This step f(x) -> 0.00120520501476678

         |    1.27612 |
∇f(x + s)|   -0.65673 |
HAVE 
  |    0.98597 |
y=|   -0.44512 |

  |   -0.02166 |
u=|   -0.03787 |
SO dot(y,u)=-0.00449643971371323
UPDATED B
  |    0.31397    0.59740 |
B=|    0.59740    1.13868 |
Step 21
  |    0.98873 |
x=|    0.97431 |

               |    1.27612 |
Numeric ∇ f(x)=|   -0.65673 |


               |    0.98040 |
This step x -> |    0.95974 |
This step f(x) -> 0.000593364802145188

         |    0.52819 |
∇f(x + s)|   -0.28936 |
HAVE 
  |   -0.74793 |
y=|    0.36737 |

  |    0.00703 |
u=|    0.01394 |
SO dot(y,u)=-0.000136054499400046
UPDATED B
  |   -0.04929   -0.12303 |
B=|   -0.12303   -0.29012 |
Step 22
  |    0.98040 |
x=|    0.95974 |

               |    0.52819 |
Numeric ∇ f(x)=|   -0.28936 |


               |    0.98040 |
This step x -> |    0.95974 |
This step f(x) -> 0.000593364802246912

         |    0.52819 |
∇f(x + s)|   -0.28936 |
HAVE 
  |    0.00000 |
y=|   0.00000 |

  |   0.00000 |
u=|   0.00000 |
SO dot(y,u)=-2.63982188254461E-23
Reset B to identity
  |    1.00000    0.00000 |
B=|    0.00000    1.00000 |
Step 23
  |    0.98040 |
x=|    0.95974 |

               |    0.52819 |
Numeric ∇ f(x)=|   -0.28936 |


               |    0.97937 |
This step x -> |    0.96031 |
This step f(x) -> 0.00055552257038739

         |   -0.48788 |
∇f(x + s)|    0.22802 |
HAVE 
  |   -1.01607 |
y=|    0.51738 |

  |    1.01504 |
u=|   -0.51681 |
SO dot(y,u)=-1.29873305336681
UPDATED B
  |    0.20669    0.40392 |
B=|    0.40392    0.79434 |
Step 24
  |    0.97937 |
x=|    0.96031 |

               |   -0.48788 |
Numeric ∇ f(x)=|    0.22802 |


               |    0.98811 |
This step x -> |    0.97625 |
This step f(x) -> 0.000142669140767952

         |    0.02097 |
∇f(x + s)|   -0.02264 |
HAVE 
  |    0.50885 |
y=|   -0.25066 |

  |    0.00481 |
u=|    0.00951 |
SO dot(y,u)=6.30960627440607E-05
UPDATED B
  |    0.57347    1.12931 |
B=|    1.12931    2.22897 |
Step 25
  |    0.98811 |
x=|    0.97625 |

               |    0.02097 |
Numeric ∇ f(x)=|   -0.02264 |


               |    1.00165 |
This step x -> |    1.00303 |
This step f(x) -> 1.03640972570855E-05

         |    0.11402 |
∇f(x + s)|   -0.05526 |
HAVE 
  |    0.09305 |
y=|   -0.03262 |

  |   -0.00298 |
u=|   -0.00559 |
SO dot(y,u)=-9.49454055277823E-05
UPDATED B
  |    0.48001    0.95404 |
B=|    0.95404    1.90027 |
Step 26
  |    1.00165 |
x=|    1.00303 |

               |    0.11402 |
Numeric ∇ f(x)=|   -0.05526 |


               |    0.99964 |
This step x -> |    0.99926 |
This step f(x) -> 1.81712519417376E-07

         |    0.00864 |
∇f(x + s)|   -0.00467 |
HAVE 
  |   -0.10538 |
y=|    0.05059 |

  |    0.00031 |
u=|    0.00064 |
SO dot(y,u)=-5.42044844954921E-07
Reset B to identity
  |    1.00000    0.00000 |
B=|    0.00000    1.00000 |
Step 27
  |    0.99964 |
x=|    0.99926 |

               |    0.00864 |
Numeric ∇ f(x)=|   -0.00467 |


               |    0.99963 |
This step x -> |    0.99927 |
This step f(x) -> 1.77373203882412E-07

         |   -0.00853 |
∇f(x + s)|    0.00390 |
HAVE 
  |   -0.01717 |
y=|    0.00857 |

  |    0.01715 |
u=|   -0.00856 |
SO dot(y,u)=-0.000367984471206265
UPDATED B
  |    0.20026    0.39920 |
B=|    0.39920    0.80074 |
Step 28
  |    0.99963 |
x=|    0.99927 |

               |   -0.00853 |
Numeric ∇ f(x)=|    0.00390 |


               |    0.99978 |
This step x -> |    0.99956 |
This step f(x) -> 4.89296879232024E-08

         |   -0.00008 |
∇f(x + s)|   -0.00017 |
HAVE 
  |    0.00845 |
y=|   -0.00407 |

  |    0.00009 |
u=|    0.00017 |
SO dot(y,u)=2.4886969553349E-08
Reset B to identity
  |    1.00000    0.00000 |
B=|    0.00000    1.00000 |
BREAK DUE TO: gradient reached target

                     |    0.99978 |
Got predicted root x=|    0.99956 |

         |    0.99978 |
Has f(x)=|    0.99956 |

FAIL this is not within 10^-3 of (1,1)
